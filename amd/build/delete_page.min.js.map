{"version":3,"file":"delete_page.min.js","sources":["../src/delete_page.js"],"sourcesContent":["import {call as fetchMany} from 'core/ajax';\r\nimport Log from 'core/log';\r\nimport ModalDeleteCancel from 'core/modal_delete_cancel';\r\nimport ModalEvents from 'core/modal_events';\r\nimport {get_string as getString} from 'core/str';\r\nimport {execReloadPage as reloadPage} from 'mod_mootimeter/reload_page';\r\nimport {removeGetParam} from 'mod_mootimeter/utils';\r\n\r\nexport const init = async(id) => {\r\n    const pageid = document.getElementById('mootimeterstate').dataset.pageid;\r\n\r\n    const modal = await ModalDeleteCancel.create({\r\n        title: getString('delete', 'core'),\r\n        body: getString('areyousure'),\r\n    });\r\n\r\n    modal.getRoot().on(ModalEvents.delete, function() {\r\n        execDeletePage(pageid);\r\n    });\r\n\r\n    const element = document.getElementById(id);\r\n    if (element) {\r\n        element.addEventListener('click', () => {\r\n            modal.show();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Call to store input value\r\n     * @param {int} pageid\r\n     * @returns {mixed}\r\n     */\r\n    const deletePageCall = (\r\n        pageid,\r\n    ) => fetchMany([{\r\n        methodname: 'mod_mootimeter_delete_page',\r\n        args: {\r\n            pageid\r\n        },\r\n    }])[0];\r\n\r\n    /**\r\n     * Executes the call to store input value.\r\n     * @param {int} pageid\r\n     */\r\n    const execDeletePage = async(pageid) => {\r\n        var mtmstate = document.getElementById('mootimeterstate');\r\n        const response = await deletePageCall(pageid);\r\n        if (response.code != 200) {\r\n            Log.error(response.string);\r\n            return;\r\n        }\r\n        removeGetParam('pageid', window.location.href);\r\n        mtmstate.setAttribute('data-pageid', 0);\r\n        reloadPage(0, response.cmid);\r\n    };\r\n};\r\n"],"names":["async","pageid","document","getElementById","dataset","modal","ModalDeleteCancel","create","title","body","getRoot","on","ModalEvents","delete","execDeletePage","element","id","addEventListener","show","mtmstate","response","methodname","args","deletePageCall","code","window","location","href","setAttribute","cmid","error","string"],"mappings":"qlBAQoBA,MAAAA,WACVC,OAASC,SAASC,eAAe,mBAAmBC,QAAQH,OAE5DI,YAAcC,6BAAkBC,OAAO,CACzCC,OAAO,mBAAU,SAAU,QAC3BC,MAAM,mBAAU,gBAGpBJ,MAAMK,UAAUC,GAAGC,sBAAYC,QAAQ,WACnCC,eAAeb,iBAGbc,QAAUb,SAASC,eAAea,IACpCD,SACAA,QAAQE,iBAAiB,SAAS,KAC9BZ,MAAMa,gBAsBRJ,eAAiBd,MAAAA,aACfmB,SAAWjB,SAASC,eAAe,yBACjCiB,cAdNnB,CAAAA,SACC,cAAU,CAAC,CACZoB,WAAY,6BACZC,KAAM,CACFrB,OAAAA,WAEJ,GAQuBsB,CAAetB,QACjB,KAAjBmB,SAASI,gCAIE,SAAUC,OAAOC,SAASC,MACzCR,SAASS,aAAa,cAAe,mCAC1B,EAAGR,SAASS,oBALfC,MAAMV,SAASW"}