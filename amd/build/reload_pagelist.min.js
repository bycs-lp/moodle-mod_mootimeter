define("mod_mootimeter/reload_pagelist",["exports","core/ajax","core/log","core/notification","core/templates","mod_mootimeter/reload_page"],(function(_exports,_ajax,_log,_notification,_templates,_reload_page){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.execReloadPagelist=void 0,_log=_interopRequireDefault(_log),_templates=_interopRequireDefault(_templates);_exports.init=()=>{if(!document.getElementById("mootimeterstate"))return;setInterval((()=>{!function(){var pageid=document.getElementById("mootimeterstate").dataset.pageid;"undefined"!=pageid&&0!=pageid.length||(pageid=0);const queryString=window.location.search,cmid=new URLSearchParams(queryString).get("id");execReloadPagelist(pageid,cmid)}()}),5e3);const queryString=window.location.search,urlParams=new URLSearchParams(queryString),cmid=urlParams.get("id");var pageid=urlParams.get("pageid");null!=pageid&&0!=pageid.length||(pageid=0),(0,_reload_page.execReloadPage)(pageid,cmid,"")};const reloadPagelist=(pageid,cmid)=>(0,_ajax.call)([{methodname:"mod_mootimeter_get_pages_list",args:{pageid:pageid,cmid:cmid}}])[0],execReloadPagelist=async function(pageid,cmid){let forcereload=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const response=await reloadPagelist(pageid,cmid);if(200!=response.code&&_log.default.error(response.string),200==response.code){var mtmstate=document.getElementById("mootimeterstate");const pagelist=JSON.parse(response.pagelist);if(mtmstate.dataset.pagelisttime==pagelist.pagelisttime&&!forcereload)return;mtmstate.setAttribute("data-pagelisttime",pagelist.pagelisttime),_templates.default.renderForPromise("mod_mootimeter/elements/snippet_page_list",pagelist).then((_ref=>{let{html:html,js:js}=_ref;return _templates.default.replaceNodeContents("#mootimeter-pages-list",html,js),!0})).catch((error=>(0,_notification.exception)(error)))}};_exports.execReloadPagelist=execReloadPagelist}));

//# sourceMappingURL=reload_pagelist.min.js.map