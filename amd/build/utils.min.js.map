{"version":3,"file":"utils.min.js","sources":["../src/utils.js"],"sourcesContent":["import {exception as displayException} from 'core/notification';\r\nimport Templates from 'core/templates';\r\nimport {call as fetchMany} from 'core/ajax';\r\n\r\n/**\r\n * Generate an info box.\r\n * @param {string} apendtoelementid\r\n * @param {string} infoboxid\r\n * @param {string} notificationType\r\n * @param {string} notificationString\r\n */\r\nexport const renderInfoBox = async(apendtoelementid, infoboxid, notificationType, notificationString) => {\r\n    const context = {\r\n        \"notification_id\": infoboxid,\r\n        \"notification_type\": notificationType,\r\n        \"notification_icon\": \"fa-exclamation\",\r\n        \"notification_text\": notificationString\r\n    };\r\n\r\n    Templates.renderForPromise('mod_mootimeter/elements/snippet_notification', context)\r\n        .then(({html, js}) => {\r\n            Templates.appendNodeContents('#' + apendtoelementid, html, js);\r\n            return true;\r\n        })\r\n        .catch((error) => displayException(error));\r\n};\r\n\r\n/**\r\n * Remove the info box.\r\n * @param {string} infoboxid\r\n */\r\nexport const removeInfoBox = async(infoboxid) => {\r\n    var infobox = document.getElementById(infoboxid);\r\n    if (infobox) {\r\n        infobox.remove();\r\n    }\r\n};\r\n\r\n/**\r\n * Set the Query Parameter.\r\n * @param {string} key\r\n * @param {string} value\r\n */\r\nexport const setGetParam = (key, value) => {\r\n    if (history.pushState) {\r\n        var params = new URLSearchParams(window.location.search);\r\n        params.set(key, value);\r\n        var newUrl = window.location.origin\r\n            + window.location.pathname\r\n            + '?' + params.toString();\r\n        window.history.pushState({path: newUrl}, '', newUrl);\r\n    }\r\n};\r\n\r\n/**\r\n * Get an array of all url search params.\r\n * @param {string} url\r\n * @returns {array}\r\n */\r\nexport const getGetParams = (url = window.location) => {\r\n    // Create a params object\r\n    let params = {};\r\n    new URL(url).searchParams.forEach(function(val, key) {\r\n        params[key] = val;\r\n    });\r\n    return params;\r\n};\r\n\r\n/**\r\n * Remove a defined parameter from url, without reload the page.\r\n * @param {string} parameter\r\n * @returns {string}\r\n */\r\nexport const removeGetParam = (parameter) => {\r\n    var url = document.location.href;\r\n    var urlparts = url.split('?');\r\n\r\n    if (urlparts.length >= 2) {\r\n        var urlBase = urlparts.shift();\r\n        var queryString = urlparts.join(\"?\");\r\n\r\n        var prefix = encodeURIComponent(parameter) + '=';\r\n        var pars = queryString.split(/[&;]/g);\r\n        for (var i = pars.length; i-- > 0;) {\r\n            if (pars[i].lastIndexOf(prefix, 0) !== -1) {\r\n                pars.splice(i, 1);\r\n            }\r\n        }\r\n        url = urlBase + '?' + pars.join('&');\r\n\r\n        // Push the new url directly to url bar .\r\n        window.history.pushState('', document.title, url);\r\n\r\n    }\r\n    return url;\r\n};\r\n\r\n/**\r\n * Call to store input value\r\n * @param {string} ajaxmethode\r\n * @param {int} pageid\r\n * @param {string} inputname\r\n * @param {string} inputvalue\r\n * @param {string} thisDataset\r\n * @returns {mixed}\r\n */\r\nexport const ajaxRequestInput = (\r\n    ajaxmethode,\r\n    pageid,\r\n    inputname,\r\n    inputvalue,\r\n    thisDataset\r\n) => fetchMany([{\r\n    methodname: ajaxmethode,\r\n    args: {\r\n        pageid,\r\n        inputname,\r\n        inputvalue,\r\n        thisDataset\r\n    },\r\n}])[0];\r\n\r\n/**\r\n * Sets a timeout to delay the next steps.\r\n *\r\n * @param {int} ms\r\n * @returns {mixed}\r\n */\r\nexport const delay = ms => new Promise(resolve => setTimeout(resolve, ms));\r\n"],"names":["async","apendtoelementid","infoboxid","notificationType","notificationString","context","renderForPromise","then","_ref","html","js","appendNodeContents","catch","error","infobox","document","getElementById","remove","key","value","history","pushState","params","URLSearchParams","window","location","search","set","newUrl","origin","pathname","toString","path","url","URL","searchParams","forEach","val","parameter","href","urlparts","split","length","urlBase","shift","queryString","join","prefix","encodeURIComponent","pars","i","lastIndexOf","splice","title","ajaxmethode","pageid","inputname","inputvalue","thisDataset","methodname","args","ms","Promise","resolve","setTimeout"],"mappings":"ocAW6BA,MAAMC,iBAAkBC,UAAWC,iBAAkBC,4BACxEC,QAAU,iBACOH,4BACEC,mCACA,mCACAC,uCAGfE,iBAAiB,+CAAgDD,SACtEE,MAAKC,WAACC,KAACA,KAADC,GAAOA,mCACAC,mBAAmB,IAAMV,iBAAkBQ,KAAMC,KACpD,KAEVE,OAAOC,QAAU,2BAAiBA,iCAOdb,MAAAA,gBACrBc,QAAUC,SAASC,eAAed,WAClCY,SACAA,QAAQG,+BASW,CAACC,IAAKC,YACzBC,QAAQC,UAAW,KACfC,OAAS,IAAIC,gBAAgBC,OAAOC,SAASC,QACjDJ,OAAOK,IAAIT,IAAKC,WACZS,OAASJ,OAAOC,SAASI,OACvBL,OAAOC,SAASK,SAChB,IAAMR,OAAOS,WACnBP,OAAOJ,QAAQC,UAAU,CAACW,KAAMJ,QAAS,GAAIA,gCASzB,eAACK,2DAAMT,OAAOC,SAElCH,OAAS,cACTY,IAAID,KAAKE,aAAaC,SAAQ,SAASC,IAAKnB,KAC5CI,OAAOJ,KAAOmB,OAEXf,gCAQoBgB,gBACvBL,IAAMlB,SAASU,SAASc,KACxBC,SAAWP,IAAIQ,MAAM,QAErBD,SAASE,QAAU,EAAG,SAClBC,QAAUH,SAASI,QACnBC,YAAcL,SAASM,KAAK,KAE5BC,OAASC,mBAAmBV,WAAa,IACzCW,KAAOJ,YAAYJ,MAAM,SACpBS,EAAID,KAAKP,OAAQQ,KAAM,IACY,IAApCD,KAAKC,GAAGC,YAAYJ,OAAQ,IAC5BE,KAAKG,OAAOF,EAAG,GAGvBjB,IAAMU,QAAU,IAAMM,KAAKH,KAAK,KAGhCtB,OAAOJ,QAAQC,UAAU,GAAIN,SAASsC,MAAOpB,YAG1CA,+BAYqB,CAC5BqB,YACAC,OACAC,UACAC,WACAC,eACC,cAAU,CAAC,CACZC,WAAYL,YACZM,KAAM,CACFL,OAAAA,OACAC,UAAAA,UACAC,WAAAA,WACAC,YAAAA,gBAEJ,kBAQiBG,IAAM,IAAIC,SAAQC,SAAWC,WAAWD,QAASF"}