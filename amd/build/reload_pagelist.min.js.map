{"version":3,"file":"reload_pagelist.min.js","sources":["../src/reload_pagelist.js"],"sourcesContent":["import { call as fetchMany } from 'core/ajax';\nimport Log from 'core/log';\n\nexport const init = () => {\n    var obj = document.getElementById('mootimeterstate');\n\n    if (!obj) {\n        return;\n    }\n\n    setInterval(() => {\n        getPagelist();\n    }, 5000);\n\n    /**\n     * Store the value.\n     */\n    function getPagelist() {\n        var pageid = document.getElementById('mootimeterstate').dataset.pageid;\n        const queryString = window.location.search;\n        const urlParams = new URLSearchParams(queryString);\n        const cmid = urlParams.get('id');\n        execReloadPagelist(pageid, cmid);\n    }\n};\n\n/**\n  * Call to store input value\n  * @param {int} pageid\n  * @param {int} cmid\n  * @returns {array}\n  */\nconst ReloadPagelist = (\n    pageid,\n    cmid\n) => fetchMany([{\n    methodname: 'mod_mootimeter_get_pages_list',\n    args: {\n        pageid,\n        cmid\n    },\n}])[0];\n\n/**\n * Executes the call to store input value.\n * @param {int} pageid\n * @param {int} cmid\n */\nconst execReloadPagelist = async (pageid, cmid) => {\n    const response = await ReloadPagelist(pageid, cmid);\n    window.console.log(response);\n    if (response.code != 200) {\n        Log.error(response.string);\n    }\n\n    if (response.code == 200) {\n        // document.getElementById('mootimeter-pages-list').innerHTML = response.pagelist;\n\n\n        // var element = document.getElementById(uniqueID);\n        // var dataset = element.dataset;\n        // var iconid = dataset.iconid;\n\n        // document.getElementById(iconid).classList.remove(dataset.iconenabled);\n        // document.getElementById(iconid).classList.remove(dataset.icondisabled);\n\n        // if (response.newstate == 1) {\n        //     document.getElementById(iconid).classList.add(dataset.iconenabled);\n        //     document.getElementById(uniqueID).setAttribute('data-original-title', dataset.tooltipdisabled);\n        // }\n\n        // if (response.newstate != 1) {\n        //     document.getElementById(iconid).classList.add(dataset.icondisabled);\n        //     document.getElementById(uniqueID).setAttribute('data-original-title', dataset.tooltipenabled);\n        // }\n\n        // // To force the webservice to pull all results.\n        // let nodelastupdated = document.getElementById('mootimeterstate');\n        // nodelastupdated.setAttribute('data-lastupdated', 0);\n\n    }\n};"],"names":["document","getElementById","setInterval","pageid","dataset","queryString","window","location","search","cmid","URLSearchParams","get","execReloadPagelist","getPagelist","async","response","methodname","args","ReloadPagelist","console","log","code","error","string"],"mappings":"+PAGoB,KACNA,SAASC,eAAe,oBAMlCC,aAAY,qBAQJC,OAASH,SAASC,eAAe,mBAAmBG,QAAQD,aAC1DE,YAAcC,OAAOC,SAASC,OAE9BC,KADY,IAAIC,gBAAgBL,aACfM,IAAI,MAC3BC,mBAAmBT,OAAQM,MAX3BI,KACD,YAoCDD,mBAAqBE,MAAOX,OAAQM,cAChCM,cAjBa,EACnBZ,OACAM,QACC,cAAU,CAAC,CACZO,WAAY,gCACZC,KAAM,CACFd,cACAM,cAEJ,GAQuBS,CAAef,OAAQM,MAC9CH,OAAOa,QAAQC,IAAIL,UACE,KAAjBA,SAASM,mBACLC,MAAMP,SAASQ,QAGnBR,SAASM"}