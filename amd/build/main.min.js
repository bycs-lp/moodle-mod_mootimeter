define("mod_mootimeter/main",["exports","core/ajax","core/log","core/modal_factory","core/modal_events","core/str"],(function(_exports,_ajax,_log,_modal_factory,_modal_events,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_log=_interopRequireDefault(_log),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events);_exports.init=async()=>{var elements=document.getElementsByClassName("mootimeter_pages_li");elements&&Array.from(elements).forEach((element=>{element.addEventListener("click",(()=>{var pageid=(void 0).dataset.pageid,cmid=(void 0).dataset.cmid;location.href="view.php?id="+cmid+"&pageid="+pageid}))}));var addnewpagebtn=document.getElementById("mootimeter_addpage");addnewpagebtn&&addnewpagebtn.addEventListener("click",(()=>{const cmid=(void 0).dataset.cmid;location.href="view.php?id="+cmid+"&a=addpage"}));const modal=await _modal_factory.default.create({type:_modal_factory.default.types.DELETE_CANCEL,title:(0,_str.get_string)("delete","core"),body:(0,_str.get_string)("areyousure"),pageid:5});modal.getRoot().on(_modal_events.default.delete,(function(){var pageid=document.getElementById("btn-delete_page").dataset.pageid;execDeletePage(pageid)}));var deletebtns=document.getElementsByClassName("mootimeter-delete-page-btn");deletebtns&&Array.from(deletebtns).forEach((element=>{element.addEventListener("click",(()=>{modal.show()}))}));const execDeletePage=async pageid=>{const response=await(pageid=>(0,_ajax.call)([{methodname:"mod_mootimeter_delete_page",args:{pageid:pageid}}])[0])(pageid);200==response.code?window.location.href=window.location.origin+window.location.pathname+"?id="+response.cmid:_log.default.error(response.string)}}}));

//# sourceMappingURL=main.min.js.map