define("mootimetertool_wordcloud/redraw_wordcloud",["exports","core/ajax","mootimetertool_wordcloud/wordcloud2","core_filters/events"],(function(_exports,_ajax,_wordcloud,_events){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_wordcloud=(obj=_wordcloud)&&obj.__esModule?obj:{default:obj};const observerRegistry=new Map;_exports.init=id=>{if(!document.getElementById(id))return;!async function(id){await getAnswers(id)}(id),setTimeout((()=>{const intervalms=document.getElementById("mootimeterstate").dataset.refreshinterval,interval=setInterval((()=>{document.getElementById(id)?getAnswers(id):clearInterval(interval)}),intervalms)}),2e3);document.getElementById("mootimeterstate").setAttribute("data-wclastupdated",0)};const getAnswers=async id=>{if(!document.getElementById(id))return;var pageid=document.getElementById(id).dataset.pageid;const mtmstate=document.getElementById("mootimeterstate");if(mtmstate.dataset.wclastupdated&&mtmstate.dataset.wclastupdated==mtmstate.dataset.contentchangedat)return;const response=await((pageid,lastupdated)=>(0,_ajax.call)([{methodname:"mootimetertool_wordcloud_get_answers",args:{pageid:pageid,lastupdated:lastupdated}}])[0])(pageid);mtmstate.setAttribute("data-wclastupdated",mtmstate.dataset.contentchangedat);const container=document.getElementById(id);container&&(container.setAttribute("data-answers",JSON.stringify(response.answerlist)),function(container){if(!container||observerRegistry.has(container.id))return;const observer=new MutationObserver((mutations=>{if(!document.body.contains(container))return observer.disconnect(),void observerRegistry.delete(container.id);for(const mutation of mutations)if(mutation.addedNodes.length>0)for(const node of mutation.addedNodes)"SPAN"===node.tagName&&node.classList.add("filter_mathjaxloader_equation");(0,_events.notifyFilterContentUpdated)([container])}));observer.observe(container,{childList:!0}),observerRegistry.set(container.id,observer)}(container),function(container){let answers=JSON.parse(container.dataset.answers);(0,_wordcloud.default)(container,{list:answers,weightFactor:24,color:"#f98012",fontFamily:"OpenSans"})}(container))}}));

//# sourceMappingURL=redraw_wordcloud.min.js.map