{"version":3,"file":"redraw_wordcloud.min.js","sources":["../src/redraw_wordcloud.js"],"sourcesContent":["import Ajax from 'core/ajax';\nimport notification from 'core/notification';\n\nexport const init = () => {\n    setInterval(function () {\n\n        var pageid = document.getElementById('mootimeter_type_answer').dataset.pageid;\n        var lastposttimestamp = document.getElementById('mootimeter_lastupdated').value;\n        const promise = Ajax.call([{\n            methodname: 'mootimetertool_wordcloud_get_answers',\n            args: {\n                pageid: pageid,\n                lastupdated: lastposttimestamp\n            },\n            fail: notification.exception,\n        }]);\n\n        promise[0].then(function (results) {\n            if (results.lastupdated == lastposttimestamp) {\n                return;\n            }\n\n            // Set lastupdated.\n            let nodelastupdated = document.getElementById('mootimeter_lastupdated');\n            nodelastupdated.value = results.lastupdated;\n\n            // Redraw wordcloud.\n            let mtmtcanvas = document.getElementById('wordcloudcanvas');\n            mtmtcanvas.setAttribute('data-answers', JSON.stringify(results.answerlist));\n            document.getElementById('wordcloudcanvas').dispatchEvent(new Event(\"redrawwordcloud\"));\n\n            return;\n        }).fail();\n\n    }, 1000);\n\n};\n"],"names":["setInterval","pageid","document","getElementById","dataset","lastposttimestamp","value","Ajax","call","methodname","args","lastupdated","fail","notification","exception","then","results","setAttribute","JSON","stringify","answerlist","dispatchEvent","Event"],"mappings":"4YAGoB,KAChBA,aAAY,eAEJC,OAASC,SAASC,eAAe,0BAA0BC,QAAQH,OACnEI,kBAAoBH,SAASC,eAAe,0BAA0BG,MAC1DC,cAAKC,KAAK,CAAC,CACvBC,WAAY,uCACZC,KAAM,CACFT,OAAQA,OACRU,YAAaN,mBAEjBO,KAAMC,sBAAaC,aAGf,GAAGC,MAAK,SAAUC,YAClBA,QAAQL,aAAeN,yBAKLH,SAASC,eAAe,0BAC9BG,MAAQU,QAAQL,YAGfT,SAASC,eAAe,mBAC9Bc,aAAa,eAAgBC,KAAKC,UAAUH,QAAQI,aAC/DlB,SAASC,eAAe,mBAAmBkB,cAAc,IAAIC,MAAM,uBAGpEV,SAEJ"}